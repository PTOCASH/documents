# PTO Whitepaper

## 1. PTO-DeFi
PTO-DeFi has created one new and upgraded version of the DeFi protocol, creating a more open decentralized financial system. On the one hand, the development of Defi will further upgrade the organizational structure and business model of traditional financial industry, upgrade to a multilateral platform collaboration model, improve the liquidity of mainstream digital currencies and expand value recognition, and build a new business and financial system. This provides the possibility of truly inclusive finance, making it more convenient for each user to create credible value based on smart contracts, and complete the expected premium of new opportunities for wealth on the chain.
The PTO-DeFi ecosystem is a recompilation of one credible digital economy based on smart contracts. The PTO itself will develop a series of basic protocols such as wallet, payment, identity authentication, asset issuance, etc., and introduce more and more open finance protocol. DeFi business involves the transaction and storage of a large number of digital assets. PTO uses a layered consensus protocol stack to ensure the security of protocols, contracts, data, and networks.

## 2. PTO application layer protocol
The PTO application layer is based on new discoveries in the application market, freely combining the required protocol layers, and implementing application landing. Especially for decentralized exchanges, PTO is realized by a combination of wallet agreement, lending agreement, custody agreement and exchange agreement.

## 3. PTO ecology
In the PTO ecology, every user can use smart contracts for contractual transactions and automated settlement of assets. Users can make them to apply the digital assets to trigger smart contracts to implement mortgage custody services to increase their investment income and promote the prosperous development of the developed PTO-based DAPP and application public chain, which has enabled the interconnection and integration of various applications, integrated the capital flow, information flow, and trust flow on and off the chain, and accelerated the splendid bloom of the distributed business world.

## 4. PTO core business structure
PTO's DeFi business module includes six product modules: PTO exchange/creation of exchange trading pairs, PUSD stable currency, market maker mining, decentralized contract mining, decentralized loan mining, and derivative protocol mining.

## 5. PTO token ecology
PTO is also regarded as the certificate of the PTO-DeFi ecology, which is responsible for transactions, agreement asset anchoring, decentralized loan mining, contract mining, mortgage issuance of synthetic assets, mining pool incentives, community governance and other functions. It is automatically performed blockchain asset allocation through smart contract agreements., allowing PTO ecological users to share the PTO's DeFi commercial value.

## 6. PTO exchange technology operation logic
### 6.1 How PTO works
PTO is an automated liquidity protocol powered by a constant product formula and implemented in a system of non-upgradeable smart contracts on the EOS block- chain. It obviates the need for trusted intermediaries, prioritizing decentralization, censorship resistance, and security. PTO is open-source software licensed under the GPL.
Each PTO smart contract, or pair, manages a liquidity pool made up of reserves of two EOS tokens.
Anyone can become a liquidity provider for a pool by depositing an equivalent value of each underlying token in return for pool tokens. These tokens track pro-rata LP shares of the total reserves, and can be redeemed for the underlying assets at any time.
Pairs act as automated market makers, standing ready to accept one token for the other as long as the “constant product” formula is preserved. This formula, most simply expressed as x * y = k, states that trades must not change the product (k) of a pair’s reserve balances (x and y). Because k remains unchanged from the reference frame of a trade, it is often referred to as the invariant. This formula has the desirable property that larger trades (relative to reserves) execute at exponentially worse rates than smaller ones.
In practice, PTO applies a 0.30% fee to trades, which is added to reserves. As a result, each trade actually increases k. This functions as a payout to LPs, which is realized when they burn their pool tokens to withdraw their portion of total reserves. In the future, this fee may be reduced to 0.25%, with the remaining 0.05% withheld as a protocol-wide charge.
Because the relative price of the two pair assets can only be changed through trading, divergences between the PTO price and external prices create arbitrage opportuni- ties. This mechanism ensures that PTO prices always trend toward the market-clearing price.

### 6.2 PTO Ecosystem
The PTO ecosystem is primarily comprised of three types of users: liquidity providers, traders, and devel- opers. Liquidity providers are incentivized to contrib- ute EOS tokens to common liquidity pools. Traders can swap these tokens for one another for a fixed 0.30% fee (which goes to liquidity providers). Devel- opers can integrate directly with PTO smart contracts to power new and exciting interactions with tokens, trading interfaces, retail experiences, and more.
In total, interactions between these classes create a positive feedback loop, fueling digital economies by defining a common language through which tokens can be pooled, traded and used.

### 6.3 PTO Liquidity
Liquidity providers, or LPs, are not a homogenous group:Passive LPs are token holders who wish to pas- sively invest their assets to accumulate trading fees.Pro- fessional LPs are focused on market making as their primary strategy. They usually develop custom tools and ways of tracking their liquidity positions across different DeFi projects.Token projects sometimes choose to become LPs to create a liquid marketplace for their token. This allows tokens to be bought and sold more easily, and unlocks interopability with other DeFi proj- ects through PTO.Finally, some DeFi pioneers are exploring complex liquidity provision interactions like incentivized liquidity, liquidity as collateral, and other experimental strategies. PTO is the perfect protocol for projects to experiment with these kinds of ideas.

### 6.4 Swap Traders
There are a several categories of traders in the proto- col ecosystem:Speculators use a variety of communi- ty built tools and products to swap tokens using liquidity pulled from the PTO protocol.Arbitrage bots seek profits by comparing prices across different platforms to find an edge. (Though it might seem extractive, these bots actually help equalize prices across broader EOS markets and keep things fair.)DAPP users buy tokens on PTO for use in other applications on EOS.Smart contracts that execute trades on the protocol by implementing swap func- tionality.In all cases, trades are subject to the same flat fee for trading on the protocol. Each is important for increasing the accuracy of prices and incentivizing liquidity.

### 6.5 Decentralized
The marginal price offered by PTO (not including fees) at time t can be computed by dividing the reserves of asset a by the reserves of asset b.
Since arbitrageurs will trade with PTO if this price is incor- rect (by a sufficient amount to make up for the fee), the price offered by PTO tends to track the relative market price of the assets. This means it can be used as an approxi- mate price oracle.
PTO improves this oracle functionality by measuring and recording the price before the first trade of each block (or equivalently, after the last trade of the previous block). This price is more difficult to manipulate than prices during a block. If the attacker submits a transaction that attempts to manipulate the price at the end of a block, some other arbi- trageur may be able to submit another transaction to trade back immediately afterward in the same block. A miner (or an attacker who uses enough gas to fill an entire block) could manipulate the price at the end of a block, but unless they mine the next block as well, they may not have a par- ticular advantage in arbitraging the trade back.
Specifically, PTO accumulates this price, by keeping track of the cumulative sum of prices at the beginning of each block in which someone interacts with the contract. Each price is weighted by the amount of time that has passed since the last block in which it was updated, according to the block timestamp. This means that the accumulator value at any given time (after being updat- ed) should be the sum of the spot price at each second in the history of the contract.
To estimate the time-weighted average price from time t1 to t2, an external caller can checkpoint the accumulator’s value at t1 and then again at t2, subtract the first value from the second, and divide by the number of seconds elapsed. (Note that the contract itself does not store historical values for this accumulator—the caller has to call the contract at the beginning of the period to read and store this value.)
Users of the oracle can choose when to start and end this period. Choosing a longer period makes it more expensive for an attacker to manipulate the TWAP, although it results in a less up-to-date price.
One complication: should we measure the price of asset A in terms of asset B, or the price of asset B in terms of asset A? While the spot price of A in terms of B is always the recip- rocal of the spot price of B in terms of A, the mean price of asset A in terms of asset B over a particular period of time is not equal to the reciprocal of the mean price of asset B in terms of asset A.
For example, if the USD/EOS price is 100 in block 1 and 300 in block 2, the average USD/EOS price will be 200 USD/EOS, but the average EOS/USD price will be 1/150 EOS/USD. Since the contract cannot know which of the two assets users would want to use as the unit of account, PTO tracks both prices.
Another complication is that it is possible for some- one to send assets to the pair contract—and thus change its balances and marginal price—without interacting with it, and thus without triggering an oracle update. If the contract simply checked its own balances and updated the oracle based on the current price, an attacker could manipulate the oracle by sending an asset to the contract immediately before calling it for the first time in a block. If the last trade was in a block whose timestamp was X seconds ago, the contract would incorrectly multiply the new price by X before accumulating it, even though nobody has had an opportunity to trade at that price. To prevent this, the core contract caches its reserves after each interaction, and updates the oracle using the price derived from the cached reserves rather than the current reserves.

## 7. PTO issuance
PTO issues PTO tokens on the EOS main chain, with a total issuance of 210 million, which are linearly released by mining. At present, they are mainly anchored as decentralized loan mining, contract mining, mortgage issuance, synthetic assets, and mining pool incentives, as well as community governance and other functional scenarios. It is automatically executed PTO digital asset distribution through smart contract agreements, allowing PTO ecological users to share the commercial value of DeFi.
Among them, the mining incentive pool of market maker has a total allocation of 42 million PTO, and mining pool release rule of its PTO market maker is: contract execution is calculated based on the completion of the 6-year release, and the monthly release output decreases the remaining 5% pool balance; the total allocation of decentralized contract mining pools is 42 million PTO (locked), the total allocation of decentralized contract lending mining pools is 21 million PTO (locked), and the total allocation of other derivative contract mining pools is 105 million PTO (locked).

## 8. PTO Agreement
8.1 Exchange
Flash swap refers to a decentralized token exchange agreement and an automatic market-making agreement. The agreement provides the exchange price in real time through a constant product algorithm, and users can complete the token exchange instantly. In addition to token exchange, users can freely create an exchange market, or choose to join an already created market to become a market maker and provide liquidity for the market (deposit two tokens in proportion). The market maker will automatically earn the commission paid by the transaction user according to the proportion of liquidity.

8.2 PUSD stable currency
PUSD stable currency is a decentralized mortgage stable currency on EOS. The stable currency PUSD (1:1 anchored US dollar) issued by collateralizing EOS can meet various needs such as leveraged trading and obtaining liquidity. The system adopts a risk control mechanism of over-collateralization and liquidation to avoid market fluctuations

8.3 PTO market maker
A PTO market maker who provides liquidity funds can get 100% transaction fees and PTO rewards from the market maker mining pool.

